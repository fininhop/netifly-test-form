<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Commande de pain bio cuits au feu de bois</title>
    <!-- Local minimal fallback for Bootstrap (loaded first) -->
    <link href="assets/bootstrap-fallback.css" rel="stylesheet">
    <!-- Bootstrap 5 CSS (CDN) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 20px; line-height: 1.6; min-height: 100vh; }
        .form-container { max-width: 600px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 8px 32px rgba(0,0,0,0.12); border: 1px solid rgba(255,255,255,0.3); }
        h1 { text-align: center; color: #2c3e50; margin-bottom: 30px; font-size: 26px; font-weight: 700; letter-spacing: -0.5px; }
        .form-group { margin-bottom: 25px; }
        .form-group label { display: block; font-weight: 500; margin-bottom: 8px; color: #333; font-size: 14px; }
        .question-number { background: #3498db; color: white; border-radius: 50%; width: 20px; height: 20px; display: inline-flex; align-items: center; justify-content: center; font-size: 12px; margin-right: 10px; }
        input[type="text"], input[type="email"], input[type="tel"], input[type="date"], textarea, .quantity-control input { width: 100%; padding: 12px; border: 2px solid #e1e8ed; border-radius: 6px; font-size: 14px; transition: border-color 0.3s; }
        input[type="text"]:focus, input[type="email"]:focus, input[type="tel"]:focus, input[type="date"]:focus, textarea:focus, .quantity-control input:focus { outline: none; border-color: #3498db; }
        .product-section { background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; }
        .basket-info { background: #e8f4fd; padding: 10px; border-radius: 6px; margin-bottom: 20px; text-align: center; color: #2980b9; font-weight: 500; }
        .product-grid { display: grid; gap: 15px; }
        .product-item { background: white; padding: 15px; border-radius: 8px; border: 2px solid #e1e8ed; display: flex; justify-content: space-between; align-items: center; transition: border-color 0.3s; }
        .product-item:hover { border-color: #3498db; }
        .product-info { flex: 1; }
        .product-name { font-weight: 600; color: #2c3e50; margin-bottom: 5px; }
        .product-price { color: #27ae60; font-weight: 600; font-size: 16px; }
        .quantity-control { display: flex; align-items: center; gap: 10px; }
        .quantity-control button { background: #3498db; color: white; border: none; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; font-size: 16px; display: flex; align-items: center; justify-content: center; }
        .quantity-control button:hover { background: #2980b9; }
        .quantity-control input { width: 60px; text-align: center; border: 1px solid #ddd; padding: 5px; border-radius: 4px; }
        .radio-group { display: flex; gap: 20px; margin-top: 10px; }
        .radio-item { display: flex; align-items: center; gap: 8px; }
        .radio-item input[type="radio"] { width: auto; }
        .submit-section { margin-top: 40px; padding-top: 30px; border-top: 2px solid #ecf0f1; }
        .submit-buttons { display: grid; grid-template-columns: 1fr; gap: 15px; margin-top: 20px; } /* Simplifi√© √† un seul bouton */
        .submit-btn { padding: 15px 25px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; text-decoration: none; text-align: center; transition: all 0.3s; display: flex; align-items: center; justify-content: center; gap: 10px; background: linear-gradient(45deg, #3498db, #2980b9); color: white; }
        .submit-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .submit-info { background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 20px; color: #27ae60; font-weight: 500; text-align: center; }
        .total-section { background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 20px 0; text-align: right; }
        .total-amount { font-size: 18px; font-weight: 700; color: #2c3e50; }
        .status-message { padding: 10px; border-radius: 4px; margin-top: 20px; font-weight: bold; text-align: center; }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        @media (max-width: 600px) {
            .form-container { margin: 10px; padding: 20px; }
            .submit-buttons { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container py-4">
        <div class="form-container mx-auto shadow-sm">
        <h1>Commande de pain bio cuits au feu de bois</h1>
        <p style="text-align: right; margin-bottom: 10px;">
            <a href="gestionnaire.html" style="color: #3498db; text-decoration: underline;">Acc√©der au Gestionnaire</a> | 
            <a href="#" id="logoutLink" style="color: #e74c3c; text-decoration: underline;">Se d√©connecter</a>
        </p>
        
        <form id="clientOrderForm"> 
            
            <div class="form-group">
                <label><span class="question-number">1</span> Type de pain</label>
                
                <div class="product-section">
                    <div class="basket-info" id="basket-info-message">
                        No product in your basket.
                    </div>
                    
                    <div class="product-grid">
                        <div class="product-item" data-product-id="blanc_400g" data-price="3.60">
                            <div class="product-info">
                                <div class="product-name">Blanc 400g</div>
                                <div class="product-price">‚Ç¨ 3.60</div>
                            </div>
                            <div class="quantity-control">
                                <span>Unit√©:</span>
                                <button type="button" onclick="changeQuantity('blanc_400g', -1)">-</button>
                                <input type="number" id="blanc_400g" name="blanc_400g" value="0" min="0" onchange="updateTotal()">
                                <button type="button" onclick="changeQuantity('blanc_400g', 1)">+</button>
                            </div>
                        </div>
                        
                        <div class="product-item" data-product-id="blanc_800g" data-price="6.50">
                            <div class="product-info">
                                <div class="product-name">Blanc 800g</div>
                                <div class="product-price">‚Ç¨ 6.50</div>
                            </div>
                            <div class="quantity-control">
                                <span>Unit√©:</span>
                                <button type="button" onclick="changeQuantity('blanc_800g', -1)">-</button>
                                <input type="number" id="blanc_800g" name="blanc_800g" value="0" min="0" onchange="updateTotal()" class="quantity-input">
                                <button type="button" onclick="changeQuantity('blanc_800g', 1)">+</button>
                            </div>
                        </div>
                        
                        <div class="product-item" data-product-id="blanc_1kg" data-price="7.00">
                            <div class="product-info">
                                <div class="product-name">Blanc 1kg</div>
                                <div class="product-price">‚Ç¨ 7.00</div>
                            </div>
                            <div class="quantity-control">
                                <span>Unit√©:</span>
                                <button type="button" onclick="changeQuantity('blanc_1kg', -1)">-</button>
                                <input type="number" id="blanc_1kg" name="blanc_1kg" value="0" min="0" onchange="updateTotal()" class="quantity-input">
                                <button type="button" onclick="changeQuantity('blanc_1kg', 1)">+</button>
                            </div>
                        </div>
                        
                        <div class="product-item" data-product-id="complet_400g" data-price="3.60">
                            <div class="product-info">
                                <div class="product-name">Complet 400g</div>
                                <div class="product-price">‚Ç¨ 3.60</div>
                            </div>
                            <div class="quantity-control">
                                <span>Unit√©:</span>
                                <button type="button" onclick="changeQuantity('complet_400g', -1)">-</button>
                                <input type="number" id="complet_400g" name="complet_400g" value="0" min="0" onchange="updateTotal()" class="quantity-input">
                                <button type="button" onclick="changeQuantity('complet_400g', 1)">+</button>
                            </div>
                        </div>
                        
                        <div class="product-item" data-product-id="complet_800g" data-price="6.50">
                            <div class="product-info">
                                <div class="product-name">Complet 800g</div>
                                <div class="product-price">‚Ç¨ 6.50</div>
                            </div>
                            <div class="quantity-control">
                                <span>Unit√©:</span>
                                <button type="button" onclick="changeQuantity('complet_800g', -1)">-</button>
                                <input type="number" id="complet_800g" name="complet_800g" value="0" min="0" onchange="updateTotal()" class="quantity-input">
                                <button type="button" onclick="changeQuantity('complet_800g', 1)">+</button>
                            </div>
                        </div>
                        
                        <div class="product-item" data-product-id="complet_1kg" data-price="7.00">
                            <div class="product-info">
                                <div class="product-name">Complet 1kg</div>
                                <div class="product-price">‚Ç¨ 7.00</div>
                            </div>
                            <div class="quantity-control">
                                <span>Unit√©:</span>
                                <button type="button" onclick="changeQuantity('complet_1kg', -1)">-</button>
                                <input type="number" id="complet_1kg" name="complet_1kg" value="0" min="0" onchange="updateTotal()" class="quantity-input">
                                <button type="button" onclick="changeQuantity('complet_1kg', 1)">+</button>
                            </div>
                        </div>
                        
                        <div class="product-item" data-product-id="cereale_400g" data-price="4.60">
                            <div class="product-info">
                                <div class="product-name">C√©r√©ale 400g</div>
                                <div class="product-price">‚Ç¨ 4.60</div>
                            </div>
                            <div class="quantity-control">
                                <span>Unit√©:</span>
                                <button type="button" onclick="changeQuantity('cereale_400g', -1)">-</button>
                                <input type="number" id="cereale_400g" name="cereale_400g" value="0" min="0" onchange="updateTotal()" class="quantity-input">
                                <button type="button" onclick="changeQuantity('cereale_400g', 1)">+</button>
                            </div>
                        </div>
                        
                        <div class="product-item" data-product-id="cereale_800g" data-price="8.50">
                            <div class="product-info">
                                <div class="product-name">C√©r√©ale 800g</div>
                                <div class="product-price">‚Ç¨ 8.50</div>
                            </div>
                            <div class="quantity-control">
                                <span>Unit√©:</span>
                                <button type="button" onclick="changeQuantity('cereale_800g', -1)">-</button>
                                <input type="number" id="cereale_800g" name="cereale_800g" value="0" min="0" onchange="updateTotal()" class="quantity-input">
                                <button type="button" onclick="changeQuantity('cereale_800g', 1)">+</button>
                            </div>
                        </div>
                        
                        <div class="product-item" data-product-id="cereale_1kg" data-price="9.00">
                            <div class="product-info">
                                <div class="product-name">C√©r√©ale 1kg</div>
                                <div class="product-price">‚Ç¨ 9.00</div>
                            </div>
                            <div class="quantity-control">
                                <span>Unit√©:</span>
                                <button type="button" onclick="changeQuantity('cereale_1kg', -1)">-</button>
                                <input type="number" id="cereale_1kg" name="cereale_1kg" value="0" min="0" onchange="updateTotal()" class="quantity-input">
                                <button type="button" onclick="changeQuantity('cereale_1kg', 1)">+</button>
                            </div>
                        </div>
                        
                        <div class="product-item" data-product-id="epeautre_400g" data-price="4.60">
                            <div class="product-info">
                                <div class="product-name">√âpeautre 400g</div>
                                <div class="product-price">‚Ç¨ 4.60</div>
                            </div>
                            <div class="quantity-control">
                                <span>Unit√©:</span>
                                <button type="button" onclick="changeQuantity('epeautre_400g', -1)">-</button>
                                <input type="number" id="epeautre_400g" name="epeautre_400g" value="0" min="0" onchange="updateTotal()" class="quantity-input">
                                <button type="button" onclick="changeQuantity('epeautre_400g', 1)">+</button>
                            </div>
                        </div>
                        
                        <div class="product-item" data-product-id="epeautre_800g" data-price="8.50">
                            <div class="product-info">
                                <div class="product-name">√âpeautre 800g</div>
                                <div class="product-price">‚Ç¨ 8.50</div>
                            </div>
                            <div class="quantity-control">
                                <span>Unit√©:</span>
                                <button type="button" onclick="changeQuantity('epeautre_800g', -1)">-</button>
                                <input type="number" id="epeautre_800g" name="epeautre_800g" value="0" min="0" onchange="updateTotal()" class="quantity-input">
                                <button type="button" onclick="changeQuantity('epeautre_800g', 1)">+</button>
                            </div>
                        </div>
                        
                        <div class="product-item" data-product-id="epeautre_1kg" data-price="9.00">
                            <div class="product-info">
                                <div class="product-name">√âpeautre 1kg</div>
                                <div class="product-price">‚Ç¨ 9.00</div>
                            </div>
                            <div class="quantity-control">
                                <span>Unit√©:</span>
                                <button type="button" onclick="changeQuantity('epeautre_1kg', -1)">-</button>
                                <input type="number" id="epeautre_1kg" name="epeautre_1kg" value="0" min="0" onchange="updateTotal()" class="quantity-input">
                                <button type="button" onclick="changeQuantity('epeautre_1kg', 1)">+</button>
                            </div>
                        </div>
                        
                        <div class="product-item" data-product-id="sarrazin" data-price="7.00">
                            <div class="product-info">
                                <div class="product-name">Sarrazin</div>
                                <div class="product-price">‚Ç¨ 7.00</div>
                            </div>
                            <div class="quantity-control">
                                <span>Unit√©:</span>
                                <button type="button" onclick="changeQuantity('sarrazin', -1)">-</button>
                                <input type="number" id="sarrazin" name="sarrazin" value="0" min="0" onchange="updateTotal()" class="quantity-input">
                                <button type="button" onclick="changeQuantity('sarrazin', 1)">+</button>
                            </div>
                        </div>
                        </div>

                    <div class="total-section">
                        <div class="total-amount">Total: ‚Ç¨ <span id="total-price">0.00</span></div>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label><span class="question-number">5</span> Date</label>
                <input type="date" id="orderDate" name="date_livraison" required class="form-control">
                <small style="color: #666; font-style: italic;">S√©lectionnez la date de livraison, les lundis de 18h √† 19h √† la mairie de Belis</small>
            </div>

            <div class="form-group">
                <label><span class="question-number">6</span> Renouveller ma commande dans 15 jours</label>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="renouveler_oui" name="renouveler" value="oui">
                        <label for="renouveler_oui">Oui</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="renouveler_non" name="renouveler" value="non" checked>
                        <label for="renouveler_non">Non</label>
                    </div>
                </div>
            </div>

            <div id="statusMessage" class="status-message hidden"></div>

            <div class="submit-section">
                <div class="submit-info">
                    Votre commande sera enregistr√©e automatiquement.
                </div>
                
                <div class="submit-buttons">
                    <button type="submit" class="submit-btn btn btn-primary">
                        üíæ Enregistrer la commande (via API)
                    </button>
                </div>
            </div>
        </form>
    </div>
    </div>
    <script src="config.js"></script>

    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>
    
    <!-- Bootstrap bundle (includes Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    // Runtime check to ensure Bootstrap is available (CSS + JS)
    (function(){
        function cssLoaded(){
            const btn = document.createElement('button');
            btn.className = 'btn btn-primary d-none';
            document.body.appendChild(btn);
            const bg = window.getComputedStyle(btn).backgroundColor;
            document.body.removeChild(btn);
            return !!bg && bg !== 'rgba(0, 0, 0, 0)' && bg !== 'transparent';
        }
        function jsLoaded(){
            return typeof bootstrap !== 'undefined';
        }
        document.addEventListener('DOMContentLoaded', () => {
            const cssOk = cssLoaded();
            const jsOk = jsLoaded();
            if (!cssOk || !jsOk) {
                console.warn('Bootstrap check: css=' + cssOk + ' js=' + jsOk);
                const banner = document.createElement('div');
                banner.className = 'alert alert-warning text-center';
                banner.textContent = 'Attention: Bootstrap non charg√© correctement (css=' + cssOk + ', js=' + jsOk + '). V√©rifiez la connexion CDN.';
                document.body.insertBefore(banner, document.body.firstChild);
            }
        });
    })();
    </script>

    <script src="script-client.js"></script>
    
</body>
</html>
