<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Commande de Pain Bio</title>
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Crect width='48' height='48' rx='8' fill='%23f5d28f'/%3E%3Ctext x='50%25' y='56%25' font-size='28' text-anchor='middle' fill='%236b3f0a' font-family='Arial,Helvetica,sans-serif'%3E%F0%9F%8C%9E%3C/text%3E%3C/svg%3E">
    <link href="assets/bootstrap-fallback.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:#fff; padding:20px; padding-bottom:90px; line-height:1.6; min-height:100vh; }
        .form-container { width:100%; max-width:950px; margin:0 auto; background:#fff; padding:35px; border-radius:12px; box-shadow:0 4px 20px rgba(0,0,0,0.08); border:1px solid #e9ecef; }
        #clientOrderForm { width:100%; }
        h1 { color:#2c3e50; font-size:26px; font-weight:700; }
        .form-group { margin-bottom:25px; }
        .form-group label { display:block; font-weight:500; margin-bottom:8px; color:#333; font-size:14px; }
        input[type="text"], input[type="email"], input[type="tel"], input[type="date"], textarea, .quantity-control input { width:100%; padding:12px; border:2px solid #e1e8ed; border-radius:6px; font-size:14px; transition:border-color .3s; }
        input:focus, textarea:focus { outline:none; border-color:#3498db; }
        .product-section { background:#f8f9fa; padding:20px; border-radius:8px; margin:20px 0; }
        .basket-info { padding:12px; border-radius:6px; margin-bottom:20px; text-align:center; font-weight:500; border:1px solid; }
        .basket-info.alert-info { background:#d1ecf1; border-color:#bee5eb; color:#0c5460; }
        .basket-info.alert-warning { background:#fff3cd; border-color:#ffc107; color:#856404; }
        .card { transition: transform 0.2s, box-shadow 0.2s; }
        .card:hover { transform: translateY(-3px); box-shadow: 0 6px 16px rgba(0,0,0,0.15) !important; }
        .radio-group { display:flex; gap:20px; margin-top:10px; }
        .radio-item { display:flex; align-items:center; gap:8px; }
        .submit-section { margin-top:40px; padding-top:30px; border-top:2px solid #ecf0f1; }
        .submit-buttons { display:grid; grid-template-columns:1fr; gap:15px; margin-top:20px; }
        .submit-btn { padding:15px 25px; border:none; border-radius:8px; font-size:16px; font-weight:600; cursor:pointer; text-decoration:none; text-align:center; transition:.3s; display:flex; align-items:center; justify-content:center; gap:10px; background:linear-gradient(45deg,#3498db,#2980b9); color:#fff; }
        .submit-btn:hover { transform:translateY(-2px); box-shadow:0 5px 15px rgba(0,0,0,0.2); }
        .header-btn { padding:8px 16px; border:none; border-radius:6px; font-size:14px; font-weight:500; cursor:pointer; text-decoration:none; text-align:center; transition:.3s; display:flex; align-items:center; justify-content:center; gap:6px; background:linear-gradient(45deg,#3498db,#2980b9); color:#fff; }
        .header-btn:hover { transform:translateY(-1px); box-shadow:0 3px 10px rgba(0,0,0,0.15); }
        .header-btn-outline { padding:8px 16px; border:2px solid #3498db; border-radius:6px; font-size:14px; font-weight:500; cursor:pointer; text-decoration:none; text-align:center; transition:.3s; display:flex; align-items:center; justify-content:center; gap:6px; background:transparent; color:#3498db; }
        .header-btn-outline:hover { background:#3498db; color:#fff; transform:translateY(-1px); box-shadow:0 3px 10px rgba(0,0,0,0.15); }
        .submit-info { background:#e8f5e8; padding:15px; border-radius:8px; margin-bottom:20px; color:#27ae60; font-weight:500; text-align:center; }
        .total-section { background:#f8f9fa; padding:15px; border-radius:8px; margin:20px 0; text-align:right; }
        .total-amount { font-size:18px; font-weight:700; color:#2c3e50; }
        .status-message { padding:10px; border-radius:4px; margin-top:20px; font-weight:bold; text-align:center; }
        .success { background-color:#d4edda; color:#155724; }
        .error { background-color:#f8d7da; color:#721c24; }
        @media (max-width:768px){ 
            .form-container { margin:10px; padding:20px; }
            .d-flex.gap-2 { flex-direction:column; }
            h1 { font-size:20px; }
        }
        .container { max-width: 950px; }
    </style>
</head>
<body>
    <div class="container py-4">
        <div class="form-container mx-auto shadow-sm">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h1 class="mb-0">Commande de pain bio cuits au feu de bois</h1>
                <div class="d-flex gap-2">
                    <a href="my-orders.html" class="header-btn-outline">ðŸ“‹ Mes commandes</a>
                    <a href="#" id="logoutLink" class="header-btn">Se dÃ©connecter</a>
                </div>
            </div>
            <form id="clientOrderForm">
                
                <div class="form-group">
                    <label>SÃ©lectionnez vos produits</label>
                    <div class="product-section">
                        <div class="basket-info" id="basket-info-message">Aucun produit dans votre panier.</div>
                        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3 mb-3" id="productGrid">
                            <!-- Products will be dynamically injected -->
                        </div>
                        <div class="total-section">
                            <div class="total-amount">Total: â‚¬ <span id="total-price">0.00</span></div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="seasonSelect">Saison de commande</label>
                    <select id="seasonSelect" name="season" required class="form-control">
                        <option value="">SÃ©lectionnez une saison...</option>
                    </select>
                    <small class="text-muted fst-italic">Choisissez la saison pour laquelle vous souhaitez commander</small>
                </div>
                
                <div id="statusMessage" class="status-message hidden"></div>
                <div class="submit-section">
                    <div class="submit-info">Votre commande sera enregistrÃ©e automatiquement.</div>
                    <div class="submit-buttons">
                        <button type="submit" class="submit-btn btn btn-primary">ðŸ’¾ Enregistrer la commande (via API)</button>
                        <a href="my-orders.html" class="submit-btn">ðŸ“‹ Voir mes commandes</a>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <!-- Toast container -->
    <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index:1070;">
        <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <strong class="me-auto" id="toastTitle">Notification</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Fermer"></button>
            </div>
            <div class="toast-body" id="toastBody"></div>
        </div>
    </div>

    <!-- Floating basket summary bar -->
    <div id="floatingBasket" class="position-fixed bottom-0 start-0 end-0 bg-primary text-white shadow-lg p-3 d-none" style="z-index:1030;">
        <div class="container d-flex justify-content-between align-items-center">
            <div>
                <strong id="floatBasketCount">0 produit(s)</strong>
                <span class="mx-2">|</span>
                <strong>Total: â‚¬ <span id="floatBasketTotal">0.00</span></strong>
            </div>
            <button type="button" class="btn btn-light btn-sm" data-bs-toggle="offcanvas" data-bs-target="#basketOffcanvas">
                ðŸ›’ Voir le panier
            </button>
        </div>
    </div>

    <!-- Offcanvas basket sidebar -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="basketOffcanvas" aria-labelledby="basketOffcanvasLabel">
        <div class="offcanvas-header bg-light">
            <h5 class="offcanvas-title" id="basketOffcanvasLabel">ðŸ›’ Votre Panier</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Fermer"></button>
        </div>
        <div class="offcanvas-body">
            <div id="basketItemsList" class="mb-3">
                <p class="text-muted">Votre panier est vide.</p>
            </div>
            <hr>
            <div class="d-flex justify-content-between align-items-center mb-3">
                <strong>Total:</strong>
                <strong class="fs-5 text-success">â‚¬ <span id="offcanvasTotal">0.00</span></strong>
            </div>
            <button type="button" class="btn btn-primary w-100" data-bs-dismiss="offcanvas" onclick="document.getElementById('clientOrderForm').scrollIntoView({behavior:'smooth'});">
                Continuer la commande
            </button>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script-client.js"></script>
</body>
</html>
